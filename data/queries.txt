LOAD EMPLOYEE
LOAD WORKS_ON

Q1Temp1 <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn,Salary FROM Q1Temp1


cross_EE <- CROSS EMPLOYEE EMPLOYEE
Q2Temp1 <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM cross_EE
Q2Temp2 <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM Q2Temp1
Q2 <- PROJECT EMPLOYEE1_Ssn,EMPLOYEE2_Ssn,EMPLOYEE2_Bdate FROM Q2Temp2
RENAME Ssn TO EMPLOYEE1_Ssn FROM Q2
RENAME Super_ssn TO EMPLOYEE2_Ssn FROM Q2
RENAME Bdate TO EMPLOYEE2_Bdate FROM Q2


cross_EW <- CROSS EMPLOYEE WORKS_ON
Q3Temp1 <- SELECT Ssn == Essn FROM cross_EW
Q3Temp2 <- PROJECT Ssn,Sex,Pno FROM Q3Temp1
Q3Temp3 <- CROSS Q3Temp2 Q3Temp2
Q3Temp4 <- SELECT Q3Temp21_Pno == Q3Temp22_Pno FROM Q3Temp3
Q3Temp5 <- SELECT Q3Temp21_Sex != Q3Temp22_Sex FROM Q3Temp4
Q3 <- PROJECT Q3Temp21_Pno FROM Q3Temp5
RENAME Pno TO Q3Temp21_Pno FROM Q3



Q4Temp1 <- PROJECT Ssn,Super_ssn,Pno FROM Q3Temp1
Q4Temp2 <- CROSS Q4Temp1 Q4Temp1
Q4Temp3 <- SELECT Q4Temp11_Pno == Q4Temp12_Pno FROM Q4Temp2
Q4Temp4 <- SELECT Q4Temp11_Super_ssn == Q4Temp12_Ssn FROM Q4Temp3
Q4 <- PROJECT Q4Temp11_Pno FROM Q4Temp4
RENAME Pno TO Q4Temp11_Pno FROM Q4


EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
QUIT